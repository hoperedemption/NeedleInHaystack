\doxysection{imgfs.\+h}
\hypertarget{imgfs_8h_source}{}\label{imgfs_8h_source}\mbox{\hyperlink{imgfs_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{error_8h}{error.h}}"{}}\ \textcolor{comment}{/*\ Not\ needed\ in\ this\ very\ file,}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ but\ we\ provide\ it\ here,\ as\ it\ is\ required\ by}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\ all\ the\ functions\ of\ this\ lib.}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <openssl/sha.h>}\ \ \ \textcolor{comment}{//\ for\ SHA256\_DIGEST\_LENGTH}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <stdint.h>}\ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ uint32\_t,\ uint64\_t}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <stdio.h>}\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ FILE}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#define\ CAT\_TXT\ "{}EPFL\ ImgFS\ 2024"{}}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{comment}{//\ Constraints}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ MAX\_IMGFS\_NAME\ \ 31\ \ }\textcolor{comment}{//\ max.\ size\ of\ a\ ImgFS\ name}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ MAX\_IMG\_ID\ \ \ \ \ 127\ \ }\textcolor{comment}{//\ max.\ size\ of\ an\ image\ id}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{comment}{//\ For\ is\_valid\ in\ imgfs\_metadata}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ EMPTY\ \ \ \ \ 0}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ NON\_EMPTY\ 1}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{comment}{//\ imgFS\ library\ internal\ codes\ for\ different\ image\ resolutions}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ THUMB\_RES\ 0}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ SMALL\_RES\ 1}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#define\ ORIG\_RES\ \ 2}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#define\ NB\_RES\ \ \ \ 3}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#ifdef\ \_\_cplusplus}}
\DoxyCodeLine{00044\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \{}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{comment}{/*\ **********************************************************************}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ *\ TODO\ WEEK\ 07:\ DEFINE\ YOUR\ STRUCTS\ HERE.}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ *\ **********************************************************************}}
\DoxyCodeLine{00050\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structimgfs__header}{imgfs\_header}}\{}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structimgfs__header_a6c498aca3ee275614eb6928661a2e709}{name}}[MAX\_IMGFS\_NAME\ +\ 1];}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimgfs__header_a14a0eb410f2ad0c41685c9440639241d}{version}};}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimgfs__header_af89037a23442a7aa078bae288bc2f244}{nb\_files}};}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimgfs__header_aebc404807f47d4d5dd74235b4a1c7c88}{max\_files}};}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimgfs__header_acb4b7642afba19e037ef1cab69c5a4eb}{resized\_res}}[2\ *\ (NB\_RES\ -\/\ 1)];}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimgfs__header_a1f32bea12b7a6be52780953eed40f75c}{unused\_32}};}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimgfs__header_ad0724e5acf2b58a6847e8217fcb15f64}{unused\_64}};}
\DoxyCodeLine{00073\ \};}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00079\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structimg__metadata}{img\_metadata}}\{}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structimg__metadata_ae9248d66ed7826dc47d1c91b0f48835c}{img\_id}}[MAX\_IMG\_ID\ +\ 1];}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structimg__metadata_a306aa15a7f23fdba8d7ae5661a93b959}{SHA}}[SHA256\_DIGEST\_LENGTH];}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimg__metadata_a264b3c57ece6f03f14623969fc812a10}{orig\_res}}[ORIG\_RES];}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimg__metadata_ad0a5026dc55c4a10bcf03751256e017c}{size}}[NB\_RES];}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimg__metadata_ac691cc297b477341a88d9c8a73308243}{offset}}[NB\_RES];}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimg__metadata_ac8033e417eb6a3ca22042e4b26269809}{is\_valid}};}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structimg__metadata_ad807ef1d1a4a01f9aff778c1a2f7302f}{unused\_16}};}
\DoxyCodeLine{00094\ \};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00101\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structimgfs__file}{imgfs\_file}}\{}
\DoxyCodeLine{00103\ \ \ \ \ FILE*\ \mbox{\hyperlink{structimgfs__file_a6ffaaba6aeda3899f58ad049e2cc722a}{file}};}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structimgfs__header}{imgfs\_header}}\ \mbox{\hyperlink{structimgfs__file_a25c05785afd44cc1510f378743890db6}{header}};}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structimg__metadata}{img\_metadata}}*\ \mbox{\hyperlink{structimgfs__file_a39b3783b7e7e98e98468902014fe62f0}{metadata}};}
\DoxyCodeLine{00108\ \};}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00116\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{imgfs_8h_ae10f7e9d86aa5eeb1c9a6f22b204bdd7}{print\_header}}(\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structimgfs__header}{imgfs\_header}}*\ header);}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00123\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{imgfs_8h_acba0793a6c1495bc3717ebd8d3a48230}{print\_metadata}}(\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structimg__metadata}{img\_metadata}}*\ metadata);}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00132\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgfs_8h_af8ec7b62fa023bb2f0d84de391939d50}{do\_open}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ imgfs\_filename,}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ open\_mode,}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}}*\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}});}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00141\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{imgfs_8h_a0fc6336b34a24d13d080f051ca08742f}{do\_close}}(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}}*\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}});}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00148\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{imgfs_8h_af68b9ba47e9dab280480cbdc41f7bc1e}{do\_list\_mode}}\ \{}
\DoxyCodeLine{00149\ \ \ \ \ STDOUT,}
\DoxyCodeLine{00150\ \ \ \ \ JSON,}
\DoxyCodeLine{00151\ \ \ \ \ NB\_DO\_LIST\_MODES}
\DoxyCodeLine{00152\ \};}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00163\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgfs_8h_a176d7b8571884582fd334eda112cc537}{do\_list}}(\textcolor{keyword}{const}\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}}*\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}},}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{imgfs_8h_af68b9ba47e9dab280480cbdc41f7bc1e}{do\_list\_mode}}\ output\_mode,\ \textcolor{keywordtype}{char}**\ json);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00173\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgfs_8h_a38595ac989599d94d5f396e33774be03}{do\_create}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ imgfs\_filename,\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}}*\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}});}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00187\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgfs_8h_a4f2afb320968906e85ff711ca4b3050f}{do\_delete}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structimg__metadata_ae9248d66ed7826dc47d1c91b0f48835c}{img\_id}},\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}}*\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}});}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00196\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgfs_8h_ac2559bb42e25295274bce94d2432bbdf}{resolution\_atoi}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ resolution);}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00208\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgfs_8h_ae668b30251e7611bff67de0472c23b96}{do\_read}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structimg__metadata_ae9248d66ed7826dc47d1c91b0f48835c}{img\_id}},\ \textcolor{keywordtype}{int}\ resolution,\ \textcolor{keywordtype}{char}**\ image\_buffer,}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t*\ image\_size,\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}}*\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}});}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00219\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgfs_8h_af0e43dfb3bdfcef033564ab772b38124}{do\_insert}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ image\_buffer,\ \textcolor{keywordtype}{size\_t}\ image\_size,}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structimg__metadata_ae9248d66ed7826dc47d1c91b0f48835c}{img\_id}},\ \textcolor{keyword}{struct}\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}}*\ \mbox{\hyperlink{structimgfs__file}{imgfs\_file}});}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00229\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{imgfs_8h_aadeca3c1a63487bfccdbbbe64eff3aa5}{do\_gbcollect}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ imgfs\_path,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ imgfs\_tmp\_bkp\_path);}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \textcolor{preprocessor}{\#ifdef\ \_\_cplusplus}}
\DoxyCodeLine{00232\ \}}
\DoxyCodeLine{00233\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
